%\documentclass[a4paper,11pt]{article}%JHEP%
%\pdfoutput=1 % if your are submitting a pdflatex (i.e. if you have
             % images in pdf, png or jpg format)%JHEP%

%\usepackage{jheppub} % for details on the use of the package, please
                     % see the JHEP-author-manual%JHEP%

\documentclass[aps,prd,nofootinbib,preprint]{revtex4}

\usepackage[T1]{fontenc} % if needed
\usepackage{amsmath}
\usepackage{leftidx}
\usepackage{multirow}
\usepackage{enumerate}
%\usepackage{textcomp}

%\usepackage{underscore}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}

\usepackage[nottoc]{tocbibind}

\usepackage{hyperref}
%\usepackage{ulem}
\usepackage{color}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{multirow}
\usepackage{amsmath,amssymb,amsthm,amsxtra,overpic,bbm,bm,float
,epsfig}



%JHEP%
%\title{\boldmath  Flavour Symmetry Embedded - GLoBES (FaSE-GLoBES)}


%JHEP%
%\author[a]{Jian Tang,}
%\author[a]{Tse-Chun Wang}
%\affiliation[a]{School of Physics, Sun Yat-Sen University, Guangzhou 510275, China}
%\emailAdd{tangjian5@mail.sysu.edu.cn}
%\emailAdd{wangzejun@mail.sysu.edu.cn}
%\abstract{Abstract...}


%\fontsize{3}{5}\selectfont
\begin{document} 
%\title{The user manual: FlAvour Symmetry with the GLoBES library}
%\title{FlAvour Symmetry with the GLoBES library}
\title{Flavour Symmetry Embedded - GLoBES (FaSE-GLoBES)} %JHEP%
%\maketitle %JHEP%
%\flushbottom %JHEP%
\author{Jian Tang$^1$\footnote{tangjian5@mail.sysu.edu.cn}}
\author{Tse-Chun Wang$^1$\footnote{wangzejun@mail.sysu.edu.cn}}
\affiliation{$^1$School of Physics, Sun Yat-Sen University, Guangzhou 510275, China}

\begin{abstract}
Neutrino models based on flavour symmetries provide the natural way to explain the origin of tiny neutrino masses. At the dawn of precision measurements of neutrino mixing parameters, neutrino mass models can be constrained and examined by on-going and up-coming neutrino experiments. We present a supplemental tool \textbf{F}l\textbf{a}vour \textbf{S}ymmetry \textbf{E}mbedded (\textbf{FaSE}) for \textbf{G}eneral \textbf{Lo}ng \textbf{B}aseline \textbf{E}xperiment \textbf{S}imulator (\textbf{GLoBES}). It can translate the neutrino mass model inputs to standard neutrino oscillation parameters, and offers prior functions in a user-friendly way. We demonstrate the robustness of \textbf{FaSE-GLoBE} with two examples on how the model parameters can be constrained and even whether the model is excluded by an experiment or not. We wish that this toolkit will facilitate the study of new neutrino mass models in an effecient and effective manner.\\
\textbf{Keywords: Neutrino Oscillations, Leptonic Flavour Symmetry}  
\end{abstract} 

\maketitle

\section{Introduction}\label{sec:intro}

The discovery of neutrino oscillations points out the fact that neutrinos have mass, and provides an evidence beyond the Standard Model (BSM). This phenomenon is successfully described by a theoretical framework with the help of three neutrino mixing angles ($\theta_{12}$, $\theta_{13}$, $\theta_{23}$), two mass-square splittings ($\Delta m_{21}^2$, $\Delta m_{31}^2$), and one Dirac CP phase ($\delta$) \cite{Pontecorvo:1967fh,Maki:1962mu,Pontecorvo:1957qd,Esteban:2018azc}. Thanks to the great efforts in the past two decades, we almost have a complete understanding of such a neutrino oscillation framework. Nevertheless, more efforts in the neutrino oscillation experiments are needed to determine the sign of $\Delta m_{31}^2$, to measure the value of $\sin\theta_{23}$ more precisely, to discover the potential CP violation in the leptonic sector and even to constrain the size of $\delta$ \cite{Esteban:2018azc}. For these purposes, the on-going long baseline experiments (LBLs), such as the NuMI Off-axis $\nu_e$ Appearance experiment (NO$\nu$A)~\cite{Ayres:2007tu} and the Tokai-to-Kamioka experiment (T2K)~\cite{Abe:2011ks}, can answer these questions with the statistical significance $\gtrsim 3\sigma$ in most of the parameter space. Based on the analysis in T2K and NO$\nu$A, the normal mass ordering ($\Delta m_{31}^2>0$), the higher $\theta_{23}$ octant ($\theta_{23}>45^\circ$), and $\delta\sim270^\circ$ are preferred so far~\cite{Esteban:2018azc}. The future LBLs, Deep Underground Neutrino Experiment (DUNE)~\cite{Acciarri:2015uup}, Tokai to Hyper-Kamiokande (T2HK)~\cite{Abe:2014oxa}, and the medium baseline reactor experiment, the Jiangmen Underground Neutrino Observatory (JUNO)~\cite{Djurcic:2015vqa,An:2015jdp} will further complete our knowledge of neutrino oscillations.

It is clear that neutrinos carry the peculiar mass smaller than $\mathcal{O}(1)$ eV among elementary particles, although the absolute value of each neutrino mass is unknown. In addition, one of the fundamental questions with regards to neutrino properties is how neutrino masses are generated naturally. 
%The seesaw mechanism has been used to explain such a tiny mass in the neutrino sector with the help of neutrino flavor mixings. 
The seesaw mechanism has been used to explain such a tiny mass in the neutrino sector. 
%Anyhow new particles have to be introduced in such a mechanism. 
More degrees of freedom in a theoretical model, the less predictivity of observables in experiments. Furthermore, flavour symmetries are employed to reduce degrees of freedom in the neutrino mass model. These models can explain the origin of the neutrino mixing, and predict correlations of oscillation parameters (some of recent review articles are~\cite{Altarelli:2010gt,Ishimori:2010au,King:2013eh,King:2014nza,King:2015aea,King:2015ata,King:2017guk}). Before the discovery of non-zero $\theta_{13}$ by Daya Bay reactor neutrino experiment~\cite{An:2013zwz}, the `tri-bi-maximal' neutrino mixing (TBM) ansatz, which was proposed in 2002 by Horrison, Perkins, and Scott~\cite{Harrison:2002er}, was in line with experimental data:
\begin{equation*}
U_{\text{TBM}}=\left(
\begin{array}{ccc}
2/\sqrt{6} & 1/\sqrt{3} & 0\\
-1/\sqrt{6} & 1/\sqrt{3} & 1/\sqrt{2}\\
1/\sqrt{6}  & -1/\sqrt{3} & 1/\sqrt{2}
\end{array}\right).
\end{equation*} 
Given $\theta_{13}\approx 8^\circ$ measured by several reactor neutrino experiments, we have to break this mixing pattern to to obtain such non-zero value of $\theta_{13}$. One of popular proposals is to correct the tri-bi-maximal neutrino mixing such that 
\begin{equation*}
\sin\theta_{12}=(1+s)/\sqrt{3},~\sin\theta_{13}=r/\sqrt{2},~\text{and}~\sin\theta_{23}=(1+a)/\sqrt{2}.
\end{equation*}
It is relatively easy for model builders to check the validity of the neutrino mass model and constrain model parameters by the public NuFit results \cite{Esteban:2018azc}. However, there is no such a public toolkit to evaluate model predictions in future neutrino experiments. \textbf{G}eneral \textbf{Lo}ng \textbf{B}aseline \textbf{E}xperiment \textbf{S}imulator (\textbf{GLoBES}) \cite{Huber:2004ka,Huber:2007ji} is a convenient tool to simulate neutrino oscillation experiments via the Abstract Experiment Definition Language (AEDL) as one of the most popular and powerful tools in the community of neutrino oscillation physics. Some AEDL files to describe experiments are also available in \textbf{GLoBES} website, while the working group in the DUNE experiment also releases their neutrino flux information and detector descriptions in a AEDL file, provided in~\cite{Alion:2016uaj}. It is to be extended for the purpose of analysing flavour symmetry models in an universal way. 

As we are entering the era of precision measurements in the neutrino oscillations, recent works pay more attentions to how the future neutrino experiments can be used to test these flavour-symmetry neutrino mass models, \textit{e.g.}~Ref.~\cite{Ballett:2016yod,Chatterjee:2017xkb, Ding:2019zhn, Tang:2019edw, Blennow:2020snb}. In this work, we will present our simulation toolkit \textbf{F}l\textbf{a}vour \textbf{S}ymmetry \textbf{E}mbedded - \textbf{GLoBES} (\textbf{FaSE-GloBES}) in a C-library to facilitate the study in the flavour symmetry neutrino models. \textbf{FaSE} is a supplemental tool for GLoBES, written in \texttt{c/c++} language, and allows users to assign any flavour symmetry model and analyze how a flavour symmetry model is constrained by the simulated neutrino oscillation experiments.

\section{Overview FASE-GloBES}\label{sec:overview}

\textbf{FaSE-GLoBES} is written in the \texttt{c} language, and consists of two source codes \textbf{FASE\_GLoBES.c} and \textbf{model-input.c}. About these two \texttt{c}-codes, the user defines the correlations between model inputs and standard neutrino mixing parameters in \textbf{model-input.c}, while \textbf{FASE\_GLoBES.c} is an engine to perform analysis with user-specified experiments in a simulaton. Note that we define the standard neutrino mixing/oscillation parameters $\vec{\theta}_{OSC}$ ($\theta_{12}$, $\theta_{13}$, $\theta_{23}$, $\Delta m_{21}^2$, $\Delta m_{31}^2$, $\delta$) to separate from model parameters $\vec{\theta}_{Model}$ hereafter.

\begin{figure}[!h]%
\centering
\includegraphics[width=7.5in]{Figs/FASE-chart_1_2.pdf}
\caption{A scheme to correlate the model parameters with standard neutrino oscillation parameters. The error propagation is implemented in the simulation code up to the spectra analysis.}%
\label{fig:FASE}
\end{figure}


The concept of \textbf{FaSE-GLoBES} is shown in Fig.~\ref{fig:FASE}, in which three parts are shown: 1.~\textbf{the parameter translation}, 2.~\textbf{giving oscillation-parameter values}, and 3.~\textbf{the $\chi^2$-value calculation}. 
The idea behind this flow chart Fig.~\ref{fig:FASE} is that given a set of model parameters, the corresponding values in standard oscillation parameters are obtained by a translation function, which is assigned by the user in \textbf{model-input.c}. And then, through \textbf{FASE\_GLoBES.c} these oscillation-parameter values are passed into \textbf{GLoBES} library to simulate the event spectra so that we can perform physics analysis in the newly-defined $\chi^2$. 


Application Programming Interface (API) functions in \textbf{FaSE-GLoBES} are listed:
\begin{enumerate}
\item \texttt{MODEL\_init($N_{para}$)},
\item  \texttt{FASE\_glb\_probability\_matrix},
\item  \texttt{FASE\_glb\_set\_oscillation\_parameters},
\item  \texttt{FASE\_glb\_get\_oscillation\_parameters},
\item \texttt{FASE\_prior\_OSC},
\item \texttt{FASE\_prior\_model}.
\end{enumerate}
The first one is to initialise \textbf{FaSE} with the number of input parameters $N_{para}$. The next three functions need to be included to replace the default \textbf{GLoBES} probability engine by the one that can read the output from \textbf{model-input.c}, as follows.
% \vspace{0.2cm}\\
% \texttt{    glbRegisterProbabilityEngine(6,\\
%                                  \&FASE\_glb\_probability\_matrix,\\
%                                  \&FASE\_glb\_set\_oscillation\_parameters,\\
%                                  \&FASE\_glb\_get\_oscillation\_parameters,\\
%                                  NULL); }\vspace{0.2cm}\\
\begin{verbatim}
 glbRegisterProbabilityEngine(6,
                                 &FASE_glb_probability_matrix,
                                 &FASE_glb_set_oscillation_parameters,
                                 &FASE_glb_get_oscillation_parameters,
                                 NULL);
\end{verbatim}

This probability engine can work with oscillation or model parameters. It can be set by the user with the parameter \texttt{PARA} in the main code. If \texttt{PARA=STAN} (\texttt{PARA=MODEL}) the probability engine works with oscillation (model) parameters. The final two items on the API list are prior functions. Once the user gives the prior in oscillation (model) parameters, the user needs to call \texttt{FASE\_prior\_OSC} (\texttt{FASE\_prior\_model}) as follows.
% \vspace{0.2cm}\\
% \texttt{glbRegisterPriorFunction(FASE\_prior\_OSC,NULL,NULL,NULL); }  
% \\
\begin{verbatim}
 glbRegisterPriorFunction(FASE_prior_OSC,NULL,NULL,NULL);
\end{verbatim}
or
% \\
% \texttt{glbRegisterPriorFunction(FASE\_prior\_model,NULL,NULL,NULL); } \vspace{0.2cm}\\
\begin{verbatim}
 glbRegisterPriorFunction(FASE_prior_model,NULL,NULL,NULL);
\end{verbatim}

We note that except for setting the probability engine and the prior function, the other parts in the main code should follow with the GLoBES manual. 


\section{Model setting}\label{sec:model_set}

The function \texttt{MtoS} can do the translation from model parameters $\vec{\theta}_{Model}$ to oscillation parameters $\vec{\theta}_{OSC}$. After the user gives the array $\vec{\theta}_{Model}$ to the function \texttt{MtoS}, the output is the corresponding oscillation parameter $\vec{\theta}_{OSC}$, of which components are $\theta_{12}$, $\theta_{13}$, $\theta_{23}$, $\delta$, $\Delta m_{21}^2$, and $\Delta m_{31}^2$. For the first four components, values are given in the unit of \textbf{rad}, while the other two are in \textbf{eV$^2$}. These values will be passed into \textbf{FaSE\_GLoBES} to simulate experimental spectra and compute prior values.

To translate from $\vec{\theta}_{Model}$ to $\vec{\theta}_{OSC}$, the user can assign the correlation between the standard oscillation and model parameter sets, or define the mass matrix in model parameters, which will be diagonalised by the function \texttt{STAN\_OSC} to obtain the corresponding oscillation-parameter values. 
%The relation between the oscillation and model parameter sets can be derived out by the user, 
In the way of directly giving the relation between oscillation and model parameter sets, the user needs to provide
$\vec{\theta}_{Model}=\vec{f}(\vec{\theta}_{OSC})$ in the function \texttt{MtoS}.
%

The oscillation parameters can also be obtained in the way based on
\begin{equation}\label{eq:MM}
U^\dagger\mathcal{M}\mathcal{M}^\dagger U = \mathbf{M}^2,~\text{where}~\mathbf{M}^2_{\alpha\beta}=m_\alpha^2\delta_{\alpha\beta},
\end{equation}
where $\mathcal{M}$ ($\mathbf{M}$) is the neutrino mass matrix in the flavour (mass) state. The matrix $\mathcal{M}$ is given by the user with model parameters $\vec{\theta}_{Model}$. The matrix $U$ is the neutrino mixing matrix, and can be used to get mixing angles and the CP phase. The difference between any two diagonal elements of $\textbf{M}$ ($\textbf{M}_{ii}-\textbf{M}_{jj}=m_i^2-m_j^2$) is the mass-squared difference ($\Delta m_{ij}^2$). This diagnolisation Eq.~(\ref{eq:MM}) can be done by the function \texttt{STAN\_OSC}, which needs to be called in \texttt{MtoS} with outputs of the vector $\vec{\theta}_{OSC}$. 


\section{Prior setting}\label{sec:prior}
Given a set of values for model parameters, \textbf{FASE\_GLoBES.c} will obtain the corresponding oscillation-parameter values from \textbf{model-input.c}, and will pass these values to simulate event spectra and to compute the prior values. Two gaussian prior functions are provided in \textbf{FaSE}: \texttt{FASE\_prior\_OSC} and \texttt{FASE\_prior\_model}. These two functions are constructed for different purposes. If the user gives the prior in oscillation (model) parameters, the user should register \texttt{FASE\_prior\_OSC} (\texttt{FASE\_prior\_model}) with the \textbf{GLoBES} function \texttt{glbRegisterPriorFunction}, as we introduced in Sec.~\ref{sec:overview}. The user also needs to assign the parameters \texttt{PARA=STAN} (\texttt{PARA=Model}), when the user prefers to give the prior in oscillation (model) parameters. The Gaussian prior is 
\begin{equation}\label{eq:prior}
\chi^2_{prior}=\sum_{i} \frac{(\theta_i-\theta^c_i)^2}{\sigma_i^2},
\end{equation}
 where $\theta_i$ is one of parameters constrained by prior, $\theta^c_i$ ($\sigma_i$) is the central value (Gaussian width) of the prior for $\theta_i$. We note that $\theta_i$ can be either model ($\vec{\theta}_{Model}$) or oscillation parameters ($\vec{\theta}_{OSC}$).
%
The values of $\theta^c_i$ and $\sigma_i$ need to be given by the user in the main code through three arrays: \texttt{Central\_prior}, \texttt{UPPER\_prior}, and \texttt{LOWER\_prior}, in which there are six components. To treat asymmetry of width for upper ($\theta_i>\theta_i^c$) and lower ($\theta_i<\theta_i^c$) Gaussian widths, we give values in two arrays \texttt{UPPER\_prior}, and \texttt{LOWER\_prior}, respectively. If the user gives the prior in model parameters, the order of each component follows with the setup of input of the probability engine. While the user gives the prior in oscillation parameters, the six components of these three arrays in order are $\theta_{12}$, $\theta_{13}$, $\theta_{23}$, $\delta$, $\Delta m_{21}^2$, and  $\Delta m_{31}^2$. The first four parameter are in \textbf{rad}, and the final two are in \textbf{eV$^2$}.

Finally, some restrictions are imposed by the chosen flavour symmetry model. We set up these restrictions in the function \texttt{model\_restriction} in \texttt{model-input.c}. In the function \texttt{model\_restriction}, the user needs to \textit{return $1$} once the restriction is broken. For example, if the normal ordering is imposed, we give ``\texttt{ if (DMS31<0) \{ return 1;\} } '' in \texttt{model\_restriction}, where \texttt{DMS31} is the variable for $\Delta m_{31}^2$. %Then, when the restriction is broken, \texttt{model\_restriction} returns the value $1$ to the prior function \texttt{FASE\_prior\_OSC} or \texttt{FASE\_prior\_model}. 
And, if there is no restriction, we simply \textit{return $0$} in \texttt{model\_restriction} as follows.
% \vspace{0.2cm}\\
% \texttt{double model\_restriction(double model [])\{ return 0;\} }\vspace{0.2cm}\\
\begin{verbatim}
 double model_restriction(double model []){ return 0;};
\end{verbatim}

%In the following, the prior function will give $10^6$ for the $\chi^2$ value, and it will be selected out when the user studies the statistically reasonable region in the parameter space.  

\section{The definition for $\chi^2$ (based on \textbf{GLoBES})}\label{sec:chi-squared}
% {\color{red}CAN BE REMOVED}
 
The user can use \textbf{FaSE-GLoBES} to constrain model parameters. 
Suppose we have the measurement $\vec{x}$ and the likelihood function $L(\vec{\theta})=P(\vec{x}|\vec{\theta})$ for a set of parameters $\vec{\theta}=(\theta_1,...,\theta_N)$, where $P(\vec{x}|\vec{\theta})$ is the probability function for data $\vec{x}$ in favour of the hypothesis $\vec{\theta}$. The constraint of model parameters can be obtained with the statistis parameter $\chi^2\equiv \ln L(\vec{\theta})$.
The expression $\chi^2$ is used as the default \textbf{GLoBES} setting. \textcolor{red}{[JT: What is the meaning of this $\chi^2$ here?]} In more detail, the $\chi^2$ function, following the Poisson distribution, is constructed based on a log-likelihood ratio,
%\begin{equation}\label{eq:chi-squared}
\begin{align}\label{eq:chi-squared}
\chi^2(\vec{\theta}^{hyp},\xi_s,\xi_b)=&2\sum_i\left(\eta_i(\vec{\theta}^{hyp},\xi_s,\xi_b)-n_i+n_i\ln\frac{n_i}{\eta_i(\vec{\theta}^{hyp},\xi_s,\xi_b)} \right)\nonumber\\
&+p(\xi_s,\sigma_s)+p(\xi_b,\sigma_b)+\chi^2_{prior},
\end{align}
%\end{equation}
where $i$ runs over the number of bins, $\eta_i(\vec{\theta},\xi_s,\xi_b)$ is the assumed event rate in the $i$th bin and $E_i$ is the central value in this energy bin. The vector $\vec{\theta}$ consists of model or oscillation parameters. The parameters $\xi_s$ and $\xi_b$ are introduced to account for the systematic uncertainties in the normalisation for the signal (subscript $_s$) and background (subscript $_b$) components of the event rate, and are allowed to vary in the fit as nuisance parameters. For a given set of parameters $\vec{\theta}$, the event rate in the $i$th energy bin is calculated as\\
\begin{equation}
\eta_i(\vec{\theta}^{hyp},\xi_s,\xi_b)=(1+\xi_s)\times s_i+(1+\xi_b)\times b_i,
\end{equation}
where $s_i$ and $b_i$ are the expected number of signal and background events in $i$th energy bin, respectively. The nuisance parameters are constrained by the Gaussian prior $p(\xi,\sigma)=\xi^2/\sigma^2$ with corresponding uncertainties $\sigma_s$ and $\sigma_b$ for the signal and background, respectively. Finally, $\chi^2_{prior}$ is a set of Gaussian priors for hypothesis, and is expressed as Eq.~(\ref{eq:prior}). After doing all minimisations, the user obtains the $\chi^2$ value for a specific hypothesis $\vec{\theta}^{hyp}$, $\chi^2(\vec{\theta}^{hyp})$.


Based on the $\chi^2$ function Eq.~(\ref{eq:chi-squared}), we can study how model parameters can be constrained and whether a flavour-symmetry neutrino model is excluded by simulated experiments. In the following we will demonstrate with typical examples how it works, before presenting some demonstrations in next two sections.

\subsection*{Applications}

The user of \textbf{FaSE-GLoBES} is able to study how model parameters can be constrained by the simulated experiments. To do so, the user needs to simulate the true event spectrum $n_i$ with a set of model ($\vec{\theta}_{Model}^{true}$) or oscillation parameters ($\vec{\theta}_{OSC}^{true}$), \textit{i.e.}~set up $n_i(\vec{\theta}_{Model}^{true})$ or $n_i(\vec{\theta}_{OSC}^{true})$. The hypothesis $\vec{\theta}_{Model}^{hyp}$ predicts the tested event spectrum $\eta_i(\vec{\theta}_{Model}^{hyp},\xi_s,\xi_b)$. With the default settings for $\chi^2$ function as Eq.~(\ref{eq:prior}) in \textbf{FaSE-GLoBES}, the user computes the statistical quantity,
\begin{equation}\label{eq:chi_model}
\chi^2(\vec{\theta}_{Model}^{hyp}),~~\text{with}~n_i(\vec{\theta}_{Model}^{true})~\text{or}~n_i(\vec{\theta}_{OSC}^{true}).
\end{equation}
%
We note that the minimum of $\chi^2$ in the whole parameter space ($\chi^2_{min.}$) may not be $0$. Therefore, to get the precision of model parameters, the user should use the value $\Delta\chi^2(\vec{\theta}_{Model}^{hyp})\equiv \chi^2(\vec{\theta}_{Model}^{hyp})-\chi^2_{min.}$, instead of $\chi^2(\vec{\theta}_{Model}^{hyp})$ itself. By varying different hypotheses $\vec{\theta}_{Model}^{hyp}$, we will obtain the allowed region of model parameters with the statistical quantity $\Delta\chi^2(\vec{\theta}_{Model}^{hyp})$. 

The user can also study how well a flavour symmetry model explains the computed data, or predict whether the simulated experiment can exclude this model or not. In other words, the user studies the minimum of $\chi^2$ for the flavour symmetry model $\vec{\theta}_{Model}$ as a hypothesis, by assuming different true oscillation values, \textit{i.e.}~different $\vec{\theta}^{true}_{OSC}$. To do so, one can compute the same statistical quantity Eq.~(\ref{eq:chi_model}), while the true spectrum is varied with different true values $\vec{\theta}_{OSC}^{true}$. All model parameters are allowed to be varied with the user-defined prior.
%
Finally, the user might adopt Wilk's theorem to interpret results~\cite{Wilks:1938dza}. When we compare nested models, the $\Delta \chi^2$ test statistics is a random variable asymptotically distributed as a $\chi^2$-distribution with the number of degrees of freedom, which is equal to the difference in the number of free model parameters. 

In following two sections, we will present examples to demonstrate how the user can do with \textbf{FaSE-GLoBES} to constrain the model parameter and to exclude a model by the simulated experiment configuration.

\section{Constraint of model parameters}

\textbf{FaSE-GloBES} can be used to study how model parameters are constrained by simulated neutrino oscillation experiments as we introduced in Sec.~\ref{sec:chi-squared}. We take \textit{the tri-direct littlest seesaw} (TDLS)~\cite{King:2013iva,King:2015dvf,King:2016yvg} as an example. In this model, the light left-handed Majorana neutrino mass matrix is given by
\begin{equation}
\label{eq:mnu}  m_{\nu}=m_{a}\begin{pmatrix}
 1 &~ \omega  &~ \omega ^2 \\
 \omega  &~ \omega ^2 &~ 1 \\
 \omega ^2 &~ 1 &~ \omega  \\
\end{pmatrix}+e^{i\eta}m_{s}
\begin{pmatrix}
 1 &~  x &~  x \\
 x &~ x^2 &~ x^2 \\
 x &~ x^2 &~ x^2 \\
\end{pmatrix}\,,
\end{equation}
where $x$, $\eta$, $m_a$, and the ratio $r\equiv m_s/m_a$ are four parameters to be constrained by simulated data. We note that from Eq.~(\ref{eq:mnu}), $m_1=0$ and the normal mass ordering are imposed, and will need to be imposed in \textbf{FaSE-GLoBES}. Therefore, the restrictions in this model are $m_a>0$ and $r>0$.
%\begin{figure}[!h]
% \flushleft
%\hspace{15mm}\includegraphics[width=0.32\textwidth]{figs/x_eta.pdf}$~~~~~~$\\
%\hspace{15mm} \includegraphics[width=0.32\textwidth]{figs/x_r.pdf}\hspace{-11mm}
% \includegraphics[width=0.32\textwidth]{figs/eta_r.pdf}$~~~~~~$\\
%\hspace{15mm} \includegraphics[width=0.32\textwidth]{figs/x_ma.pdf}\hspace{-11mm}
% \includegraphics[width=0.32\textwidth]{figs/eta_ma.pdf}\hspace{-11mm}
% \includegraphics[width=0.32\textwidth]{figs/r_ma.pdf}
% \caption{\label{fig:model_2D}Precision measurements of any two model parameters at 3$\sigma$ confidence level in the framework of three neutrino oscillations taking uncertainties of the current global fit results, for MOMENT, at $1\sigma$ (gray), $2\sigma$ (orange), $3\sigma$ (black). True values for the model parameters are used $(x,~\eta,~r,~M_a)=(-3.65,~1.13\pi,~0.511,~3.71~\text{meV})$.}
%\end{figure}

\begin{figure}[!h]
 %\flushleft
 \centering
\includegraphics[width=0.48\textwidth]{Figs/x_eta.pdf}
 \includegraphics[width=0.48\textwidth]{Figs/theta_phi.pdf}
% \caption{\label{fig:constraint}Precision measurements of two model parameters in the framework of three neutrino oscillations taking uncertainties of the current global fit results, for MOMENT, at $1\sigma$ (gray), $2\sigma$ (orange), $3\sigma$ (black). True values for the model parameters are used $(x,~\eta,~r,~M_a)=(-3.65,~1.13\pi,~0.511,~3.71~\text{meV})$.}
 %
  \caption{\label{fig:constraint}Examples for using \textbf{FaSE-GLoBES} to obtain the constraints of model parameters for tri-direct littlest seesaw (left) and the warped flavor symmetry (right), with simulated DUNE and MOMENT data. In the left panel, the dot)denotes the prediction by the tri-direct littlest seesaw model with NuFit4.0 results.}
\end{figure}

In left panel of Fig.~\ref{fig:constraint}, we study how parameters $x$ and $\eta$ can be constrained at $3\sigma$ by the MuOn-decay MEdium baseline NeuTrino beam experiment (MOMENT)~\cite{Cao:2014bea} and DUNE experiment. 
%We input the model by giving model parameters as functions of standard oscillation parameters Eq.~(\ref{eq:modelofOSC}). 
Parameters $r$ and $ma$ are varied with the prior that is given in standard oscillation parameters, according to the global-fit result NuFit4.0. 
%The code for this example is provided as \textbf{x\_eta.c} in the \textbf{FaSE} distribution.

%\begin{figure}[!h]
% \centering
%\hspace{15mm}\includegraphics[width=0.5\textwidth]{Figs/theta_phi.pdf}
 %\caption{\label{fig:theta_phi} {\color{red}[formate will be further tuned]}}
%\end{figure}


To show the generality of \textbf{FaSE-GLoBES}, we also present the similar result for another model -- \textit{the warped flavor symmetry} (WFS)~\cite{Chen:2015jta}. This model predicts further simplified correlations that the standard oscillation parameters including mixing angles and the CP phase are functions of only two model parameters $\theta_\nu$ and $\phi_\nu$,
\begin{align}\label{eq:WFS}
\sin^2\theta_{12}&=\frac{1}{2-\sin2\theta_{\nu}\cos\phi_\nu},\nonumber\\
\sin^2\theta_{13}&=\frac{1}{3}(1+\sin2\theta_\nu\cos\phi_\nu),\nonumber\\
\sin^2\theta_{23}&=\frac{1-\sin2\theta_\nu\sin(\pi/6-\phi_\nu)}{2-\sin2\theta_\nu\cos\phi_\nu},\nonumber\\
J_{CP}&=-\frac{1}{6\sqrt{3}}\cos2\theta_\nu.
\end{align}
The constraint of $\theta_\nu$ and $\phi_\nu$ for DUNE and MOMENT is presented in the right panel of Fig~\ref{fig:constraint}, in which we use the best fit of NuFit 4.0 result as the true values $(\theta_{12},~\theta_{13},~\theta_{23},~\delta,~\Delta m_{21}^2,~\Delta m_{31}^2)=(33.82^\circ,~8.61^\circ,~49.6^\circ,~215^\circ,~7.39\times10^{-5}~\text{eV}^2,~2.525\times10^{-3}~\text{eV}^2)$. To reproduce the result shown in \cite{Chatterjee:2017xkb}, we do not include any priors. More details about these codes are presented in the user manual. 


\section{Model testing}

\begin{figure}[!h]
 \centering
\includegraphics[width=0.48\textwidth]{Figs/SR_th23_dCP_DUNE_MOMENT.pdf}
\includegraphics[width=0.48\textwidth]{Figs/SR_th23_dCP_WFS.pdf}
\caption{\label{fig:th23_delta}Examples for using \textbf{FaSE-GLoBES} to obtain the 2-D exclusion contour at $99\%$ C.L. on the plane of true values of $\theta_{23}$ and $\delta$ for sub-models of TDLS (left) and of WFS (right) with DUNE and MOMENT. In the left panel, the star (dot) denotes the prediction by the tri-direct littlest seesaw model with NuFit4.0 results (best fit of NuFit4.0).}
%\caption{\label{fig:th23_delta}The 2-D exclusion contour for sub-models of tri-direct littlest seesaw on the plane of two true standard parameters $\theta_{23}$ and $\delta$, from $1\sigma$ to $5\sigma$, for DUNE (dotted) and MOMENT (solid). The range for each parameter is taken according to the $3\sigma$ uncertainty in NuFit4.0 results. The black dot denotes the best fit of NuFit4.0 results ($(\theta_{12},~\theta_{13},~\theta_{23},~\delta,~\Delta m_{21}^2,~\Delta m_{31}^2)=(33.82^\circ,~8.61^\circ,~49.6^\circ,~215^\circ,~7.39\times10^{-5}~\text{eV}^2,~2.525\times10^{-3}~\text{eV}^2)$), while the star is the prediction by the tri-direct littlest seesaw model with NuFit4.0 results ($(\theta_{12},~\theta_{13},~\theta_{23},~\delta,~\Delta m_{21}^2,~\Delta m_{31}^2)\sim(36.25^\circ,~8.63^\circ,~47^\circ,~279^\circ,~7.39\times10^{-5}~\text{eV}^2,~2.525\times10^{-3}~\text{eV}^2)$).}
\end{figure}

We can also study on whether a neutrino mass model is excluded or not, assuming different true values for oscillation parameters. In this example, we present testing sub-models of TDLS in various true values of $\theta_{23}$ and $\delta$. We compute the minimal $\chi^2$ value for the model with $r$ and $m_a$, varied with the prior Eq.~(\ref{eq:prior}) according to NuFit4.0 results. Two parameters $x$ and $\eta$ are fixed at the best fit. In addition, the studied statistics function is exactly given by Eq.~(\ref{eq:chi-squared}), but the true event rate $n_i$ is predicted by a set of oscillation parameters, which will be varied in the code. 
%
We present this result in the left panel of Fig.~\ref{fig:th23_delta}. We further show the generality of \textbf{FaSE-GLoBES} by demonstrating the similar result for another model -- WFS Eq.~(\ref{eq:WFS}) for DUNE and MOMENT, in right panel of Fig.~\ref{fig:th23_delta}. In this result, two mass-squared differences are fixed at the true values without including any priors.
%
%As mentioned in Sec.~\ref{sec:chi-squared}, the user needs to consider Wilk's theorem with the different of degrees of freedom between the {\color{blue}assumed} true theory {\color{blue}($\vec{\theta}^{true}_{OSC}$)} and the hypothesis {\color{blue}($\vec{\theta}^{hyp}_{Model}$)}, \texttt{dof}. 
%{\color{blue}`The assumed true theory' here means that the oscillation parameters assumed for predicting the true event spectrum.} \textcolor{red}{[JT: what is the meaning of the true theory?]} 
%Here the number \texttt{dof} is $2$. 
%And that is our output: \texttt{gsl\_cdf\_chisq\_Qinv(gsl\_cdf\_chisq\_Q(fabs(res),dof),1)}. \textcolor{red}{[I don't understand this sentence.]} 
More details are presented in the user manual. 
%The code for this example is provided as \textbf{th23\_delta.c} in the \textbf{FaSE} distribution.


%\begin{figure}[!h]
 %\flushleft
%
%\includegraphics[width=0.32\textwidth]{figs/SR_th13_th23.pdf}$~~~~~~$\\
%\includegraphics[width=0.32\textwidth]{figs/SR_th13_dCP.pdf}
%\includegraphics[width=0.32\textwidth]{figs/SR_th23_dCP.pdf}$~~~~~~$\\
%\includegraphics[width=0.32\textwidth]{figs/SR_th13_ldm.pdf}
%\includegraphics[width=0.32\textwidth]{figs/SR_th23_ldm.pdf}
%\includegraphics[width=0.32\textwidth]{figs/SR_dCP_ldm.pdf}
 %\caption{\label{fig:SR_2D}The 2-D exclusion contour for tri-direct littlest seesaw model on the plane of any two true standard parameters, from $1\sigma$ to $5\sigma$. The range for each parameter is taken according to the $3\sigma$ uncertainty in NuFit4.0 results. The black dot denotes the best fit of NuFit4.0 results ($(\theta_{12},~\theta_{13},~\theta_{23},~\delta,~\Delta m_{21}^2,~\Delta m_{31}^2)=(33.82^\circ,~8.61^\circ,~49.6^\circ,~215^\circ,~7.39\times10^{-5}~\text{eV}^2,~2.525\times10^{-3}~\text{eV}^2)$), while the star is the prediction by the tri-direct littlest seesaw model with NuFit4.0 results ($(\theta_{12},~\theta_{13},~\theta_{23},~\delta,~\Delta m_{21}^2,~\Delta m_{31}^2)\sim(36.25^\circ,~8.63^\circ,~47^\circ,~279^\circ,~7.39\times10^{-5}~\text{eV}^2,~2.525\times10^{-3}~\text{eV}^2)$).}
%\end{figure}



\section{Summary and conclusions}

With the progress of precision measurements in the neutrino experiments, and the success of numerous flavour symmetry theories to explain tiny neutrino masses, there are strong motivations to test and discriminate theoretical models by the next-generation neutrino oscillation experiments. We have presented a simulation toolkit \textbf{FaSE-GLoBES} to study the leptonic flavour symmetry models with neutrino oscillation experiments in a user-friendly way. \textbf{FaSE-GLoBES} contains two \texttt{c}-codes: \textbf{model-input.c} and \textbf{FASE\_GLoBES.c}. While \textbf{FASE\_GLoBES.c} works as a bridge between models and standard neutrino mixings, all inputs from the user need to be given in \textbf{model-input.c}. With the help of two main functions provided by \textbf{FaSE}, it is convenient to assign a flavour symmetry model and include Gaussian priors associated with oscillation or model parameters. Users are able to study how a flavour model can be studied by the simulated experimental configuration in various perspectives, \textit{e.g.} model parameter constraints, hypothesis testing. {\color{blue} \textbf{FaSE-GLoBES} will contribute to the selection and screening of underlying neutrino mass models by oscillation experiments. Further improvements and extensions can be envisioned as more requests are made by users.}

\acknowledgements{
This work was supported in part by Guangdong Basic and Applied Basic Research Foundation under Grant No. 2019A1515012216, National Natural Science Foundation of China under Grant Nos. 11505301 and 11881240247, the university funding based on National SuperComputer Center-Guangzhou. Jian Tang acknowledge the support from the CAS Center for Excellence in Particle Physics (CCEPP). Tse-Chun Wang was supported in part by Postdoctoral recruitment program in Guangdong province.
}

% BIBLIOGRAPHY
% use BIBTEX if you want
\bibliographystyle{JHEP}
%\bibliographystyle{plain}
\bibliography{FAS-GLoBES.bib}
\end{document}
